(()=>{var t={n:r=>{var o=r&&r.__esModule?()=>r.default:()=>r;return t.d(o,{a:o}),o},d:(r,o)=>{for(var e in o)t.o(o,e)&&!t.o(r,e)&&Object.defineProperty(r,e,{enumerable:!0,get:o[e]})},o:(t,r)=>Object.prototype.hasOwnProperty.call(t,r),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},r={};(()=>{"use strict";t.r(r);const o=flarum.core.compat["common/app"];function e(t,r){return e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},e(t,r)}t.n(o)().initializers.add("rob006/flarum-ext-last-post-avatar",(function(){}));const s=flarum.core.compat["forum/app"];var a=t.n(s);const n=flarum.core.compat["common/extend"],i=flarum.core.compat["forum/components/TerminalPost"];var c=t.n(i);const u=flarum.core.compat["common/helpers/avatar"];var l=t.n(u);const p=flarum.core.compat["common/helpers/humanTime"];var f=t.n(p);const d=flarum.core.compat["common/helpers/icon"];var v=t.n(d);const y=flarum.core.compat["forum/components/DiscussionListItem"];var h=t.n(y);const P=flarum.core.compat["common/components/Link"];var b=t.n(P);const _=flarum.core.compat["common/components/Tooltip"];var A=t.n(_),O=function(t){return"isPrivateDiscussion"in t&&t.isPrivateDiscussion()&&a().forum.attribute("lastPostAvatarByobu")},g=function(t){var r,o;function s(){return t.apply(this,arguments)||this}return o=t,(r=s).prototype=Object.create(o.prototype),r.prototype.constructor=r,e(r,o),s.prototype.view=function(t){var r=a().forum.attribute("lastPostAvatarMode"),o=this.attrs.discussion,e=this.attrs.lastPost&&o.replyCount(),s=o[e?"lastPostedUser":"user"](),n=o[e?"lastPostedAt":"createdAt"](),i="all-replies"===r&&e||"always"===r||"non-op-replies"===r&&o.lastPostedUser()!=o.user();return m("span",null,e?v()("fas fa-reply"):""," ",!O(o)&&i?l()(s,{className:"ComposerBody-lastPostAvatar"}):"",a().translator.trans("core.forum.discussion_list."+(e?"replied":"started")+"_text",{user:s,ago:f()(n)}))},s}(c());a().initializers.add("rob006/flarum-ext-last-post-avatar",(function(){(0,n.extend)(h().prototype,"infoItems",(function(t){"replace-main"!==a().forum.attribute("lastPostAvatarMode")&&t.replace("terminalPost",g.component({discussion:this.attrs.discussion,lastPost:!this.showFirstPost()}))})),(0,n.override)(h().prototype,"view",(function(t){var r=t(),o=this.attrs.discussion;if(O(o))return r;if("replace-main"!==a().forum.attribute("lastPostAvatarMode")||this.showFirstPost()||!o.replyCount())return r;var e=o.lastPostedUser();return function t(r){if(r&&r.children&&Array.isArray(r.children)){var s=r.children.find((function(t){return t&&t.attrs&&t.attrs.className&&String(t.attrs.className).split(" ").includes("DiscussionListItem-content")}));if(s)return void s.children.splice(0,1,m(A(),{text:a().translator.trans("core.forum.discussion_list.replied_text",{user:e,ago:f()(o.createdAt())}),position:"right"},m(b(),{className:"DiscussionListItem-author",href:e?a().route.user(e):"#"},l()(e||null,{title:""}))));r.children.forEach((function(r){t(r)}))}}(r),r}))}))})(),module.exports=r})();
//# sourceMappingURL=forum.js.map