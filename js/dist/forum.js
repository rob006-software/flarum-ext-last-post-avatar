(()=>{var t={n:o=>{var r=o&&o.__esModule?()=>o.default:()=>o;return t.d(r,{a:r}),r},d:(o,r)=>{for(var e in r)t.o(r,e)&&!t.o(o,e)&&Object.defineProperty(o,e,{enumerable:!0,get:r[e]})},o:(t,o)=>Object.prototype.hasOwnProperty.call(t,o),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},o={};(()=>{"use strict";t.r(o);const r=flarum.core.compat["common/app"];function e(t,o){return e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,o){return t.__proto__=o,t},e(t,o)}t.n(r)().initializers.add("rob006/flarum-ext-last-post-avatar",(function(){}));const s=flarum.core.compat["forum/app"];var a=t.n(s);const n=flarum.core.compat["common/extend"],i=flarum.core.compat["forum/components/TerminalPost"];var c=t.n(i);const u=flarum.core.compat["common/helpers/avatar"];var l=t.n(u);const p=flarum.core.compat["common/helpers/humanTime"];var f=t.n(p);const d=flarum.core.compat["common/helpers/icon"];var v=t.n(d);const y=flarum.core.compat["forum/components/DiscussionListItem"];var h=t.n(y);const P=flarum.core.compat["common/components/Link"];var b=t.n(P);const _=flarum.core.compat["common/components/Tooltip"];var A=t.n(_),O=function(t){return a().forum.attribute("lastPostAvatarByobu")&&(null==t.isPrivateDiscussion?void 0:t.isPrivateDiscussion())},g=function(t){var o,r;function s(){return t.apply(this,arguments)||this}return r=t,(o=s).prototype=Object.create(r.prototype),o.prototype.constructor=o,e(o,r),s.prototype.view=function(){var t=a().forum.attribute("lastPostAvatarMode"),o=this.attrs.discussion,r=this.attrs.lastPost&&o.replyCount(),e=o[r?"lastPostedUser":"user"](),s=o[r?"lastPostedAt":"createdAt"](),n="all-replies"===t&&r||"always"===t||"non-op-replies"===t&&o.lastPostedUser()!=o.user();return m("span",null,r?v()("fas fa-reply"):""," ",!O(o)&&n?l()(e,{className:"ComposerBody-lastPostAvatar"}):"",a().translator.trans("core.forum.discussion_list."+(r?"replied":"started")+"_text",{user:e,ago:f()(s)}))},s}(c());a().initializers.add("rob006/flarum-ext-last-post-avatar",(function(){(0,n.extend)(h().prototype,"infoItems",(function(t){"replace-main"!==a().forum.attribute("lastPostAvatarMode")&&t.replace("terminalPost",g.component({discussion:this.attrs.discussion,lastPost:!this.showFirstPost()}))})),(0,n.override)(h().prototype,"view",(function(t){var o=t(),r=this.attrs.discussion;if("replace-main"!==a().forum.attribute("lastPostAvatarMode")||O(r)||this.showFirstPost()||!r.replyCount())return o;var e=r.lastPostedUser();return function t(o){if(o&&o.children&&Array.isArray(o.children)){var s=o.children.find((function(t){return t&&t.attrs&&t.attrs.className&&String(t.attrs.className).split(" ").includes("DiscussionListItem-content")}));if(s)return void s.children.splice(0,1,m(A(),{text:a().translator.trans("core.forum.discussion_list.replied_text",{user:e,ago:f()(r.createdAt())}),position:"right"},m(b(),{className:"DiscussionListItem-author",href:e?a().route.user(e):"#"},l()(e||null,{title:""}))));o.children.forEach((function(o){t(o)}))}}(o),o}))}))})(),module.exports=o})();
//# sourceMappingURL=forum.js.map